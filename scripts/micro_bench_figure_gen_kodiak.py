#! /usr/bin/env python

import figure

figure.kv_xxx = [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
figure.rpc_xxx = [55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65]
figure.micro_bench_xxx = [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]

if __name__ == "__main__":

    rpc_cpu_val = [0.351551978305, 0.371405750799, 0.336341525858, 0.306161563719, 0.33904462593, 0.256798623064, 0.260757314974, 0.266379804934, 0.255340848094, 0.185256139903, 0.22527301092]
    rpc_throughput_val = [210605, 213820, 217772, 219645, 225994, 227812, 231863, 234606, 236664, 240507, 241847]

    rpc_latency_50_val = 0.09072923234

    rpc_latency_90_val = 0.0916632930031

    rpc_latency_99_val = 0.0928665622796

    rpc_latency_999_val = 0.0932868016009

    cpu_val = [0.57245508982, 0.518135331193, 0.462519405633, 0.485197934596, 0.461468234789, 0.481808097615, 0.47482839348, 0.436137557879, 0.455897353304, 0.446680185099, 0.453386673739]
    kv_throughput_val = [143492, 146285, 147128, 149037, 148308, 151764, 151806, 144813, 155274, 152309, 150137]

    #kv_commit_rate_val = [5535320.0/5535320, 5981257.0/5981257, 6389330.0/6389330, 6365357.0/6365357, 6608698.0/6608698, 6534116.0/6534116, 6737237.0/6737237, 6777446.0/6777446, 6939124.0/6939124, 6981918.0/6981918, 7010164.0/7010164]

    kv_latency_50_val = 0.10178013677

    kv_latency_90_val = 0.107799575776

    kv_latency_99_val = 0.109515886524

    kv_latency_999_val = 0.109808841856

    #kv_att_latency_50_val = [0.230314939713, 0.231566936023, 0.235674364313, 0.237725545215, 0.241676323527, 0.243168521742, 0.246501842652, 0.248400081487, 0.248821914644, 0.251179559597, 0.254047909614]

    #kv_att_latency_90_val = [0.262776415233, 0.264233724466, 0.269075152117, 0.271927632738, 0.27660855585, 0.279149945969, 0.28349660697, 0.285903998094, 0.286805852859, 0.290173452466, 0.294408278942]

    #kv_att_latency_99_val = [0.272704043862, 0.274219803391, 0.279381579705, 0.282456843869, 0.287507574272, 0.290299426797, 0.295030853252, 0.297622107308, 0.298610348646, 0.302280084517, 0.30695490653]

    #kv_att_latency_999_val = [0.274187612872, 0.275705280897, 0.280907856896, 0.284014758622, 0.289114578909, 0.291955369494, 0.296743751497, 0.299353942936, 0.300362859756, 0.304079881052, 0.308825325658]

    #kv_latency_min_val = [0.0908203125, 0.08984375, 0.09130859375, 0.088623046875, 0.091796875, 0.093017578125, 0.089599609375, 0.09326171875, 0.08984375, 0.09375, 0.093017578125]

    #kv_latency_max_val = [7.85473632812, 7.76318359375, 7.31127929688, 7.85400390625, 7.88842773438, 7.50244140625, 7.90454101562, 7.58276367188, 8.29370117188, 7.26831054688, 7.98681640625]

    #kv_attempts_val = [5535320.0/38.5758726184, 5981257.0/40.8876542267, 6389330.0/43.4270868744, 6365357.0/42.7099592575, 6608698.0/44.5605816135, 6534116.0/43.0544860294, 6737237.0/44.3805129907, 6777446.0/46.8012832959, 6939124.0/44.6894526377, 6981918.0/45.8404286556, 7010164.0/46.6918594705]

    cpu_val = [
            [0.982326360457, 0.994410750386, 0.99869187775, 0.996313897768, 0.99607563325, 0.995363002652, 0.99762210484, 0.997266785502, 0.99869234427, 0.998975688574, 0.998097955302, 0.999524488825, 1.0, 0.997622062429, 0.999405398977, 0.999667110519], # none
            [0.974345307873, 0.985157442086, 0.989735053405, 0.996532112637, 0.997919267582, 0.996948778438, 0.997641836593, 0.996670828132, 0.998057983077, 0.999306422527, 0.995561104175, 0.999167764735, 0.999583853516, 0.999722569011, 0.999722569011, 0.999583853516], # occ
            [0.992786794285, 0.996393397142, 0.998890679958, 0.999167937841, 0.998705552816, 0.999583853516, 0.999833499833, 0.999231901668, 0.999861284505, 0.999445311128, 0.998196698571, 0.999861284505, 0.999815020348, 0.999028991538, 0.999743885261, 0.999359959037], # deptran
            [0.981276177933, 0.98834789846, 0.996671205931, 0.994451380219, 0.995977250659, 0.996948259121, 0.997919267582, 0.998196698571, 0.998474244964, 0.997364405604, 0.99833552947, 0.999028991538, 0.999722569011, 0.999583853516, 0.999583853516, 1.0000000577] # 2pl
            ]

    throughput_val = [
            [59379, 60810, 62537, 62807, 62951, 62350, 63062, 63354, 63373, 63112, 63143, 64159, 64704, 62748, 63697, 64350], # none
            [20385, 20807, 21265, 21726, 22136, 22047, 22281, 22101, 22184, 22362, 21970, 22246, 22223, 22608, 22714, 22579], # occ
            [23702, 24201, 24385, 24379, 24457, 24627, 24587, 24389, 24633, 24486, 24195, 24627, 24614, 24408, 24673, 24451], # deptran
            [19990, 20447, 20809, 20837, 21060, 20945, 21256, 21333, 21314, 21209, 21388, 21491, 21677, 21740, 21716, 21461] # 2pl
            ]

    #commit_rate_val = [
    #        [1534854.0/1534854, 1611233.0/1611233, 1674938.0/1674938, 1711004.0/1711004, 1701910.0/1701910, 1673504.0/1673504, 1715510.0/1715510, 1727574.0/1727574, 1773642.0/1773642, 1699877.0/1699877, 1719191.0/1719191, 1754734.0/1754734, 1802116.0/1802116, 1683497.0/1683497, 1731291.0/1731291, 1782632.0/1782632],
    #        [481293.0/481540, 492756.0/493022, 507699.0/507999, 523832.0/524111, 534362.0/534644, 534757.0/535061, 536504.0/536803, 530814.0/531154, 532517.0/532839, 538501.0/538846, 527706.0/528039, 535413.0/535804, 532989.0/533389, 546807.0/547187, 547325.0/547719, 544437.0/544854],
    #        [577843.0/577843, 591588.0/591588, 598419.0/598419, 602841.0/602841, 455238.0/455238, 605314.0/605314, 456647.0/456647, 598933.0/598933, 605230.0/605230, 602199.0/602199, 590407.0/590407, 608943.0/608943, 458802.0/458802, 597695.0/597695, 605715.0/605715, 599155.0/599155],
    #        [471044.0/471100, 483532.0/483589, 493556.0/493608, 496449.0/496520, 500806.0/500879, 497910.0/497984, 506750.0/506841, 508811.0/508884, 506839.0/506925, 504612.0/504693, 512992.0/513079, 515984.0/516081, 521027.0/521122, 520129.0/520234, 518425.0/518530, 510590.0/510705]
    #        ]

    latency_50_val = [
            0.138011864191, # none
            0.424211873872, # occ
            0.281479920698, # deptran
            0.424396903666 # 2pl
            ]

    latency_90_val = [
            0.138691877341, # none
            0.4250537251, # occ
            0.282784877124, # deptran
            0.425163078355 # 2pl
            ]

    latency_99_val = [
            0.139179725357, # none
            0.425771355796, # occ
            0.292338792327, # deptran
            0.427001990862 # 2pl
            ]

    latency_999_val = [
            0.13990354647, # none
            0.427028551475, # occ
            0.293567947201, # deptran
            0.428285203885 # 2pl
            ]

    #att_latency_50_val = [
    #        [0.138011864191],
    #        [1.14509339806, 1.18080652235, 1.21331705577, 1.25033836006, 1.27663025135, 1.28343533008, 1.30736023045, 1.36919455019, 1.39993344563, 1.43322538557, 1.51660875766, 1.53990408628, 1.58740326651, 1.61640867594, 1.68124039641, 1.70974384863],
    #        [0.961413375684, 0.983132289107, 1.03324934142, 1.10393075235, 1.12805189993, 1.1393265641, 1.17356924759, 1.22702716336, 1.25277668604, 1.3043184621, 1.38464884145, 1.39624179317, 1.41335475708, 1.4667360692, 1.49779921564, 1.54218745224],
    #        [1.17811018884, 1.21221118538, 1.26090355412, 1.27583855706, 1.2925545535, 1.36097930645, 1.38343728979, 1.41175825722, 1.47252866138, 1.52887222902, 1.551932012, 1.60098130926, 1.66015414554, 1.70398192921, 1.71544413828, 1.79474241129]
    #        ]

    #att_latency_90_val = [
    #        [0.138691877341],
    #        [1.20628340238, 1.23077331463, 1.25123196075, 1.27276003291, 1.29029127554, 1.33704944218, 1.36583724754, 1.42408030784, 1.46341393476, 1.49647554818, 1.57045588609, 1.59653279547, 1.64472294044, 1.66306146534, 1.70135301314, 1.75060091738],
    #        [1.02842960348, 1.04882363496, 1.08337239947, 1.12590288644, 1.15777371079, 1.19080810856, 1.22814131014, 1.28344044513, 1.31262734726, 1.36074862802, 1.41788200837, 1.43363791554, 1.47122712914, 1.52441807187, 1.55008915629, 1.60716366788],
    #        [1.22987130422, 1.25161335034, 1.27948760438, 1.32080659646, 1.35222192465, 1.40908109867, 1.43507181191, 1.47663540982, 1.52444880274, 1.5811208741, 1.61433067439, 1.65413742185, 1.68972569835, 1.72808751463, 1.77422955068, 1.84059981819]
    #        ]

    #att_latency_99_val = [
    #        [0.139179725357],
    #        [1.21980430357, 1.24289138526, 1.26313681703, 1.28239261016, 1.30335896572, 1.35369322761, 1.38420577709, 1.44053151266, 1.48016803601, 1.51323714838, 1.58582148933, 1.61088964025, 1.65775298166, 1.67390576471, 1.7102557427, 1.76402690396],
    #        [1.04317065561, 1.06267144185, 1.09568657475, 1.13686921173, 1.17136643333, 1.20562400577, 1.2458148903, 1.29883698079, 1.32648404147, 1.37519445883, 1.43264844073, 1.4478106348, 1.48652082664, 1.54234952721, 1.56608699116, 1.62116623325],
    #        [1.2441980329, 1.26513968106, 1.29131804061, 1.3371356478, 1.37026145089, 1.42552315584, 1.45156521294, 1.4933294871, 1.54170267419, 1.59641497372, 1.62981110904, 1.66850407749, 1.70047326446, 1.74129111746, 1.78929209902, 1.85672436119]
    #        ]

    #att_latency_999_val = [
    #        [0.13990354647],
    #        [1.22194186749, 1.24493143505, 1.265134895, 1.28419241243, 1.30556594851, 1.35609042354, 1.3866349475, 1.44305545829, 1.48263088417, 1.51556317241, 1.58822678199, 1.61313354134, 1.65983259913, 1.67581183373, 1.71195540575, 1.76635216462],
    #        [1.04541103044, 1.06483241345, 1.0976916002, 1.1387665171, 1.17372614394, 1.20792822298, 1.24812988196, 1.30126622291, 1.32868125472, 1.37732973511, 1.43499082773, 1.45019976482, 1.48878246528, 1.54472795661, 1.56848478661, 1.62340263291],
    #        [1.24654979322, 1.26743073098, 1.29344481912, 1.33968338855, 1.37285546307, 1.42813706427, 1.45413761458, 1.49579470769, 1.54406050431, 1.5988215989, 1.63218679906, 1.6707460833, 1.70248811421, 1.74360647916, 1.79165639664, 1.85931309943]
    #        ]

    #latency_min_val = [
    #        [0.209716796875, 0.22998046875, 0.177001953125, 0.232666015625, 0.216064453125, 0.2275390625, 0.22412109375, 0.150146484375, 0.231201171875, 0.243896484375, 0.157958984375, 0.22265625, 0.227294921875, 0.256591796875, 0.21875, 0.241943359375],
    #        [0.83984375, 0.84228515625, 0.8544921875, 0.85693359375, 0.99169921875, 0.960205078125, 0.98779296875, 1.00146484375, 1.02001953125, 1.1318359375, 1.11254882812, 1.15014648438, 1.26782226562, 1.22021484375, 1.29272460938, 1.40869140625],
    #        [0.58349609375, 0.69482421875, 0.73681640625, 0.67919921875, 0.6533203125, 0.728515625, 0.719970703125, 0.832763671875, 0.875244140625, 0.8671875, 0.85693359375, 0.974365234375, 1.11547851562, 1.12841796875, 0.98046875, 1.1455078125],
    #        [0.83544921875, 0.843994140625, 0.980712890625, 0.979248046875, 0.988525390625, 0.9912109375, 0.9990234375, 0.999755859375, 1.109375, 1.13598632812, 1.14965820312, 1.21313476562, 1.16748046875, 1.29760742188, 1.318359375, 1.42993164062]
    #        ]

    #latency_max_val = [
    #        [3.51806640625, 3.41967773438, 3.25634765625, 3.55029296875, 3.39111328125, 3.73559570312, 3.17529296875, 3.109375, 3.19287109375, 4.63916015625, 3.01953125, 4.64916992188, 4.95654296875, 2.96557617188, 3.09301757812, 2.86938476562],
    #        [3.70703125, 2.87548828125, 3.18359375, 3.38940429688, 3.279296875, 3.43798828125, 5.07788085938, 4.39404296875, 7.685546875, 5.91674804688, 3.61474609375, 5.72998046875, 5.87182617188, 5.00708007812, 3.72998046875, 3.88232421875],
    #        [128.370361328, 128.319824219, 129.746582031, 129.427490234, 130.728027344, 131.056152344, 131.660400391, 132.114746094, 132.01953125, 132.047607422, 134.01953125, 132.881591797, 133.597900391, 132.018066406, 132.041992188, 132.885498047],
    #        [5.43823242188, 2.89453125, 3.64331054688, 2.94848632812, 3.22387695312, 5.28662109375, 5.5625, 3.87963867188, 3.47290039062, 3.59716796875, 3.55249023438, 6.009765625, 6.03759765625, 6.00634765625, 5.88696289062, 4.84619140625]
    #        ]

    #attempts_val = [
    #        [1534854.0/25.8482988991, 1611233.0/26.4960329914, 1674938.0/26.7833577148, 1711004.0/27.2424291379, 1701910.0/27.0356710545, 1673504.0/26.8402880467, 1715510.0/27.203653895, 1727574.0/27.2687565657, 1773642.0/27.9874220053, 1699877.0/26.9343074094, 1719191.0/27.226940451, 1754734.0/27.3499737132, 1802116.0/27.8514917914, 1683497.0/26.8293600203, 1731291.0/27.1803070825, 1782632.0/27.702223577],
    #        [481540.0/23.6105182779, 493022.0/23.6816634873, 507999.0/23.8753017957, 524111.0/24.1106163679, 534644.0/24.1394919128, 535061.0/24.2554819508, 536803.0/24.0785126041, 531154.0/24.0179171101, 532839.0/24.004709559, 538846.0/24.0806664492, 528039.0/24.0195944306, 535804.0/24.067481503, 533389.0/23.9835253634, 547187.0/24.1867754844, 547719.0/24.0962934335, 544854.0/24.1125436195],
    #        [577843.0/24.379201485, 591588.0/24.4448482407, 598419.0/24.5409340049, 602841.0/24.7277822842, 455238.0/18.6136593033, 605314.0/24.5792093216, 456647.0/18.5725433563, 598933.0/24.5572399542, 605230.0/24.5701335036, 602199.0/24.5931685377, 590407.0/24.401850727, 608943.0/24.7263124933, 458802.0/18.6397117593, 597695.0/24.4875496721, 605715.0/24.5492193841, 599155.0/24.5039040876],
    #        [471100.0/23.5640421095, 483589.0/23.6476722447, 493608.0/23.7179555787, 496520.0/23.8254418321, 500879.0/23.7795665544, 497984.0/23.7724552281, 506841.0/23.8407842517, 508884.0/23.8504930413, 506925.0/23.7792822044, 504693.0/23.7920050437, 513079.0/23.98515685, 516081.0/24.0092796939, 521122.0/24.0355127079, 520234.0/23.9251019113, 518530.0/23.8733548505, 510705.0/23.7912803982]
    #        ]

    #graph_size_val = [
    #        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    #        ]

    #n_ask_val = [
    #        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    #        ]

    #scc_val = [
    #        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    #        ]


    rpc_throughput_val.sort()
    rpc_tp = rpc_throughput_val[len(rpc_throughput_val) - 1]

    kv_throughput_val.sort()
    kv_tp = kv_throughput_val[len(kv_throughput_val) - 1]

    throughput_val[0].sort() # none
    tp_none = throughput_val[0][len(throughput_val[0]) - 1]
    throughput_val[1].sort() # occ
    tp_occ = throughput_val[1][len(throughput_val[1]) - 1]
    throughput_val[2].sort() # deptran
    tp_deptran = throughput_val[2][len(throughput_val[2]) - 1]
    throughput_val[3].sort() # 2pl
    tp_2pl = throughput_val[3][len(throughput_val[3]) - 1]

    xs = ['null rpc', 'kv', 'micro / none', 'micro / occ', 'micro / 2pl', 'micro / deptran']
    throughputs = [rpc_tp, kv_tp, tp_none, tp_occ, tp_2pl, tp_deptran]

    throughput_figname = "fig/micro_tp.pdf"

    figure.micro_tp(xs, throughputs, throughput_figname);

    print "1 RPC\t& " +   str(round(rpc_latency_50_val, 3)) + " & " + str(round(rpc_latency_90_val, 3)) + " & " + str(round(rpc_latency_99_val, 3)) + " & " + str(round(rpc_latency_999_val, 3)) + " \\\\"
    print "1 RPC+DB\t& " +         str(round(kv_latency_50_val, 3)) + " & " + str(round(kv_latency_90_val, 3)) + " & " + str(round(kv_latency_99_val, 3)) + " & " + str(round(kv_latency_999_val, 3)) + " \\\\"
    print "3 RPC+DB\t& " +       str(round(latency_50_val[0], 3)) + " & " + str(round(latency_90_val[0], 3)) + " & " + str(round(latency_99_val[0], 3)) + " & " + str(round(latency_999_val[0], 3)) + " \\\\"
    print "OCC\t& "  +       str(round(latency_50_val[1], 3)) + " & " + str(round(latency_90_val[1], 3)) + " & " + str(round(latency_99_val[1], 3)) + " & " + str(round(latency_999_val[1], 3)) + " \\\\"
    print "2PL-WW\t& "  +       str(round(latency_50_val[3], 3)) + " & " + str(round(latency_90_val[3], 3)) + " & " + str(round(latency_99_val[3], 3)) + " & " + str(round(latency_999_val[3], 3)) + " \\\\"
    print "{\\DEPTRAN}\t& " +    str(round(latency_50_val[2], 3)) + " & " + str(round(latency_90_val[2], 3)) + " & " + str(round(latency_99_val[2], 3)) + " & " + str(round(latency_999_val[2], 3)) + " \\\\"

#    print("Hello")

